# 人事管理系统 - 技术文档

## 1. 项目概述 你回复 财务的不能去

本项目是一个基于前后端分离架构的人事管理系统，主要用于企业内部的员工、部门、职位和考勤信息管理。

### 1.1 核心功能
- 用户登录认证
- 部门信息管理（增删改查）
- 职位信息管理（增删改查）
- 员工信息管理（增删改查）
- 考勤记录管理（增删改查、分页查询）

### 1.2 技术架构
- **前端技术栈**：Vue 3 + Element Plus + Axios + Vite
- **后端技术栈**：Spring Boot 3.2.0 + MyBatis + MySQL + Druid
- **项目结构**：前后端分离架构

## 2. 项目环境配置

### 2.1 后端配置

**数据库配置**：
- 数据库类型：MySQL
- 数据库地址：localhost:3306
- 数据库名称：renshi
- 用户名：root
- 密码：qq618

**服务器配置**：
- 服务端口：8081
- 上下文路径：/springmvc030
- API基础路径：/api

**关键配置文件**：`application.yml`

```yaml
server:
  port: 8081
  servlet:
    context-path: /springmvc030

spring:
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    url: jdbc:mysql://localhost:3306/renshi
    username: root
    password: qq618
    driver-class-name: com.mysql.cj.jdbc.Driver
```

### 2.2 前端配置

**依赖管理**：
- Vue 3.3.4
- Vite 4.5.14
- Element Plus
- Axios

**关键配置文件**：`package.json`

```json
{
  "scripts": {
    "dev": "vite"
  },
  "dependencies": {
    "vue": "^3.3.4",
    "element-plus": "^2.4.2",
    "axios": "^1.6.2"
  }
}
```

## 3. 项目启动指南

### 3.1 后端启动步骤

1. **前提条件**：确保MySQL数据库已启动且已创建renshi数据库
2. **启动命令**：在项目根目录执行
   ```
   mvn spring-boot:run
   ```
3. **验证启动**：服务启动成功后可通过以下地址访问
   ```
   http://localhost:8081/springmvc030
   ```

### 3.2 前端启动步骤

1. **安装依赖**（如未安装）：在frontend目录执行
   ```
   npm install
   ```
2. **启动开发服务器**：
   ```
   node node_modules/vite/bin/vite.js
   ```
   或
   ```
   cd .\frontend
   npm run dev
   ```
3. **访问前端**：默认启动在http://localhost:3003/

## 4. 项目结构

### 4.1 后端项目结构

```
src/main/java/cn/edu/sju/jee/
├── controller/
│   ├── api/           # RESTful API控制器
│   │   ├── AttendanceApiController.java  # 考勤管理接口
│   │   ├── DepartmentApiController.java  # 部门管理接口
│   │   ├── EmployeeApiController.java    # 员工管理接口
│   │   ├── PositionApiController.java    # 职位管理接口
│   │   └── LoginController.java          # 登录认证接口
│   └── WebMvcConfig.java                 # Spring MVC配置
├── model/             # 数据模型
│   ├── Attendance.java     # 考勤实体类
│   ├── Department.java     # 部门实体类
│   ├── Employee.java       # 员工实体类
│   ├── Position.java       # 职位实体类
│   ├── ApiResponse.java    # 统一响应格式
│   └── PageResult.java     # 分页结果类
├── service/           # 业务逻辑层
│   ├── AttendanceService.java
│   ├── DepartmentService.java
│   ├── EmployeeService.java
│   ├── PositionService.java
│   └── LoginServiceImpl.java
├── mapper/            # MyBatis映射接口
├── dto/               # 数据传输对象
└── Application.java   # Spring Boot主启动类
```

### 4.2 关键实体类结构

#### Position实体类（根据实际代码）
```java
public class Position {
    private Integer posId;         // 职位ID
    @NotBlank(message = "职位名称不能为空")
    @Length(min = 1, max = 50, message = "职位名称长度在1-50之间")
    private String posName;        // 职位名称
    @Length(max = 200, message = "职位描述长度不能超过200")
    private String posDesc;        // 职位描述
    @NotNull(message = "所属部门不能为空")
    private Integer deptId;        // 部门ID
    private Department department; // 部门对象
    private Date createTime;       // 创建时间
    private Date updateTime;       // 更新时间
}
```

#### Department实体类（根据实际代码）
```java
public class Department {
    private Integer deptId;        // 部门ID
    @NotBlank(message = "部门名称不能为空")
    @Length(min = 1, max = 50, message = "部门名称长度在1-50之间")
    private String deptName;       // 部门名称
    @Length(max = 200, message = "部门描述长度不能超过200")
    private String deptDesc;       // 部门描述
    private Date createTime;       // 创建时间
    private Date updateTime;       // 更新时间
}
```

#### Employee实体类（根据实际代码）
```java
public class Employee {
    private Integer empId;         // 员工ID
    @NotBlank(message = "员工姓名不能为空")
    @Length(min = 1, max = 50, message = "员工姓名长度在1-50之间")
    private String empName;        // 员工姓名
    private String gender;         // 性别
    @NotBlank(message = "身份证号不能为空")
    @Pattern(regexp = "^[1-9]\\d{5}(18|19|20)\\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\\d{3}[0-9Xx]$", 
             message = "身份证号格式不正确")
    private String idCard;         // 身份证号
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "手机号格式不正确")
    private String phone;          // 手机号
    @Email(message = "邮箱格式不正确")
    private String email;          // 邮箱
    @Length(max = 200, message = "地址长度不能超过200")
    private String address;        // 地址
    @NotNull(message = "所属部门不能为空")
    private Integer deptId;        // 部门ID
    @NotNull(message = "职位不能为空")
    private Integer posId;         // 职位ID
    @DateTimeFormat(pattern = "yyyy-MM-dd")
    private Date entryDate;        // 入职日期
    private Integer status;        // 1-在职 2-离职
    private Department department; // 部门对象
    private Position position;     // 职位对象
    private Date createTime;       // 创建时间
    private Date updateTime;       // 更新时间
}
```

#### Attendance实体类（根据实际代码）
```java
public class Attendance {
    private Integer attId;         // 考勤ID
    @NotNull(message = "员工不能为空")
    private Integer empId;         // 员工ID
    @JsonFormat(pattern = "HH:mm:ss", timezone = "GMT+8")
    private Date checkIn;          // 签到时间
    @JsonFormat(pattern = "HH:mm:ss", timezone = "GMT+8")
    private Date checkOut;         // 签退时间
    private Integer status;        // 1-正常 2-迟到 3-早退 4-缺勤
    @Length(max = 200, message = "备注长度不能超过200")
    private String remark;         // 备注
    private Date createTime;       // 创建时间
    private Employee employee;     // 员工对象
}



```
frontend/src/
├── api/           # API接口调用
├── components/    # 通用组件
├── views/         # 页面视图
├── router/        # 路由配置
├── App.vue        # 根组件
└── main.js        # 入口文件
```

## 5. API接口详细文档

### 5.1 登录接口

**接口路径**：`/api/login/doLogin`
**请求方法**：POST
**请求体**：
```json
{
  "userName": "用户名",
  "password": "密码"
}
```
**完整URL**：http://localhost:8081/springmvc030/api/login/doLogin
**请求头**：Content-Type: application/json（必须设置）

### 5.2 部门管理接口（根据实际代码修正）

#### 获取所有部门
- **接口路径**：`/api/department/list`
- **请求方法**：GET
- **完整URL**：http://localhost:8081/springmvc030/api/department/list

#### 获取单个部门
- **接口路径**：`/api/department/{deptId}`
- **请求方法**：GET
- **路径参数**：deptId（部门ID）
- **完整URL**：http://localhost:8081/springmvc030/api/department/1

#### 新增部门
- **接口路径**：`/api/department/add`
- **请求方法**：POST
- **请求体**：
```json
{
  "deptName": "部门名称",
  "deptDesc": "部门描述"
}
```
- **完整URL**：http://localhost:8081/springmvc030/api/department/add
- **请求头**：Content-Type: application/json（必须设置）
- **验证规则**：deptName必填，长度1-50；deptDesc可选，最大长度200

#### 更新部门
- **接口路径**：`/api/department/update`
- **请求方法**：PUT
- **请求体**：
```json
{
  "deptId": 1,
  "deptName": "更新后的部门名称",
  "deptDesc": "更新后的部门描述"
}
```
- **完整URL**：http://localhost:8081/springmvc030/api/department/update
- **请求头**：Content-Type: application/json（必须设置）
- **验证规则**：deptId和deptName必填，deptName长度1-50；deptDesc可选，最大长度200

#### 删除部门
- **接口路径**：`/api/department/delete/{deptId}`
- **请求方法**：DELETE
- **路径参数**：deptId（部门ID）
- **完整URL**：http://localhost:8081/springmvc030/api/department/delete/1

### 5.3 职位管理接口（根据实际代码修正）

#### 获取所有职位
- **接口路径**：`/api/positions`
- **请求方法**：GET
- **完整URL**：http://localhost:8081/springmvc030/api/positions

#### 按部门查询职位
- **接口路径**：`/api/positions/dept/{deptId}`
- **请求方法**：GET
- **路径参数**：deptId（部门ID）
- **完整URL**：http://localhost:8081/springmvc030/api/positions/dept/1

#### 获取单个职位
- **接口路径**：`/api/positions/{posId}`
- **请求方法**：GET
- **路径参数**：posId（职位ID）
- **完整URL**：http://localhost:8081/springmvc030/api/positions/1

#### 新增职位
- **接口路径**：`/api/positions`
- **请求方法**：POST
- **请求体**：
```json
{
  "posName": "职位名称",
  "posDesc": "职位描述",
  "deptId": 1
}
```
- **完整URL**：http://localhost:8081/springmvc030/api/positions
- **请求头**：Content-Type: application/json（必须设置）
- **验证规则**：posName必填，长度1-50；posDesc可选，最大长度200；deptId必填

#### 更新职位
- **接口路径**：`/api/positions`
- **请求方法**：PUT
- **请求体**：
```json
{
  "posId": 1,
  "posName": "更新后的职位名称",
  "posDesc": "更新后的职位描述",
  "deptId": 1
}
```
- **完整URL**：http://localhost:8081/springmvc030/api/positions
- **请求头**：Content-Type: application/json（必须设置）
- **验证规则**：posId、posName和deptId必填，posName长度1-50；posDesc可选，最大长度200

#### 删除职位
- **接口路径**：`/api/positions/{posId}`
- **请求方法**：DELETE
- **路径参数**：posId（职位ID）
- **完整URL**：http://localhost:8081/springmvc030/api/positions/1

### 5.4 员工管理接口（根据实际代码修正）

#### 获取所有员工
- **接口路径**：`/api/employees`
- **请求方法**：GET
- **完整URL**：http://localhost:8081/springmvc030/api/employees

#### 条件查询员工
- **接口路径**：`/api/employees/query`
- **请求方法**：GET
- **查询参数**：根据EmployeeQueryParam对象的属性设置查询条件
- **完整URL示例**：http://localhost:8081/springmvc030/api/employees/query?deptId=1&empName=张

#### 获取单个员工
- **接口路径**：`/api/employees/{empId}`
- **请求方法**：GET
- **路径参数**：empId（员工ID）
- **完整URL**：http://localhost:8081/springmvc030/api/employees/1

#### 新增员工
- **接口路径**：`/api/employees`
- **请求方法**：POST
- **请求体**：
```json
{
  "empName": "员工姓名",
  "gender": "性别",
  "idCard": "身份证号",
  "phone": "13800138000",
  "email": "example@example.com",
  "address": "地址",
  "deptId": 1,
  "posId": 1,
  "entryDate": "2024-01-01",
  "status": 1
}
```
- **完整URL**：http://localhost:8081/springmvc030/api/employees
- **请求头**：Content-Type: application/json（必须设置）
- **验证规则**：
  - empName：必填，长度1-50
  - idCard：必填，必须符合身份证号格式
  - phone：必须符合手机号格式(1[3-9]\d{9})
  - email：必须符合邮箱格式
  - address：长度不超过200
  - deptId：必填
  - posId：必填

#### 更新员工
- **接口路径**：`/api/employees`
- **请求方法**：PUT
- **请求体**：
```json
{
  "empId": 1,
  "empName": "更新后的员工姓名",
  "gender": "性别",
  "idCard": "身份证号",
  "phone": "13800138000",
  "email": "example@example.com",
  "address": "地址",
  "deptId": 1,
  "posId": 1,
  "entryDate": "2024-01-01",
  "status": 1
}
```
- **完整URL**：http://localhost:8081/springmvc030/api/employees
- **请求头**：Content-Type: application/json（必须设置）
- **验证规则**：
  - empId：必填
  - empName：必填，长度1-50
  - idCard：必填，必须符合身份证号格式
  - phone：必须符合手机号格式(1[3-9]\d{9})
  - email：必须符合邮箱格式
  - address：长度不超过200
  - deptId：必填
  - posId：必填

#### 删除员工
- **接口路径**：`/api/employees/{empId}`
- **请求方法**：DELETE
- **路径参数**：empId（员工ID）
- **完整URL**：http://localhost:8081/springmvc030/api/employees/1

### 5.5 考勤管理接口（根据实际代码修正）

#### 获取所有考勤记录
- **接口路径**：`/api/attendances`
- **请求方法**：GET
- **完整URL**：http://localhost:8081/springmvc030/api/attendances

#### 分页获取考勤记录
- **接口路径**：`/api/attendances/page`
- **请求方法**：GET
- **查询参数**：page（页码，默认1），size（每页大小，默认10）
- **完整URL示例**：http://localhost:8081/springmvc030/api/attendances/page?page=1&size=10

#### 根据员工ID获取考勤记录
- **接口路径**：`/api/attendances/employee/{empId}`
- **请求方法**：GET
- **路径参数**：empId（员工ID）
- **完整URL**：http://localhost:8081/springmvc030/api/attendances/employee/1

#### 获取单个考勤记录
- **接口路径**：`/api/attendances/{attId}`
- **请求方法**：GET
- **路径参数**：attId（考勤记录ID）
- **完整URL**：http://localhost:8081/springmvc030/api/attendances/1

#### 新增考勤记录
- **接口路径**：`/api/attendances`
- **请求方法**：POST
- **请求体**：
```json
{
  "empId": 1,
  "checkIn": "09:00:00",
  "checkOut": "18:00:00",
  "status": 1,
  "remark": "备注信息"
}
```
- **完整URL**：http://localhost:8081/springmvc030/api/attendances
- **请求头**：Content-Type: application/json（必须设置）
- **验证规则**：
  - empId：必填
  - checkIn/checkOut：时间格式为HH:mm:ss
  - status：1-正常 2-迟到 3-早退 4-缺勤
  - remark：长度不超过200

#### 更新考勤记录
- **接口路径**：`/api/attendances/{attId}`
- **请求方法**：PUT
- **路径参数**：attId（考勤记录ID）
- **请求体**：
```json
{
  "empId": 1,
  "checkIn": "09:30:00",
  "checkOut": "18:00:00",
  "status": 2,
  "remark": "更新后的备注"
}
```
- **完整URL**：http://localhost:8081/springmvc030/api/attendances/1
- **请求头**：Content-Type: application/json（必须设置）
- **验证规则**：
  - empId：必填
  - checkIn/checkOut：时间格式为HH:mm:ss
  - status：1-正常 2-迟到 3-早退 4-缺勤
  - remark：长度不超过200

#### 删除考勤记录
- **接口路径**：`/api/attendances/{attId}`
- **请求方法**：DELETE
- **路径参数**：attId（考勤记录ID）
- **完整URL**：http://localhost:8081/springmvc030/api/attendances/1

## 6. API测试指南

### 6.1 使用Postman测试API

1. **打开Postman**，创建新的请求集合（Collection）
2. **设置请求方法**（GET/POST/PUT/DELETE）
3. **输入完整URL**（包括基础路径+接口路径）
4. **设置请求头**：对于POST/PUT请求，添加`Content-Type: application/json`
5. **设置请求体**：对于POST/PUT请求，在Body标签中选择raw，格式选择JSON，并输入请求体数据
6. **设置查询参数或路径参数**：根据接口要求设置相应参数
7. **发送请求**，查看响应结果
8. **验证响应**：检查HTTP状态码（200表示成功）和响应体内容

### 6.2 响应格式说明

所有接口返回统一的ApiResponse格式：

```json
{
  "success": true,       
  "message": "消息",   
  "data": {}            
}
```

## 7. 数据库设计

系统使用MySQL数据库，数据库名：renshi

### 主要数据表
- `department`：部门表
- `position`：职位表
- `employee`：员工表
- `attendance`：考勤记录表
- `tb_user`：用户登录表

## 8. 常见问题与解决方案

### 8.1 前端启动问题

如果遇到`npm run dev`命令无法执行的问题（如权限错误），可以尝试直接运行：
```
node node_modules/vite/bin/vite.js
```

### 8.2 端口占用问题

- 前端默认端口3000，如果被占用会自动切换到其他端口（如3003）
- 后端默认端口8081，可在`application.yml`中修改

### 8.3 数据库连接问题

确保MySQL数据库已启动，并且数据库名、用户名、密码与`application.yml`中配置一致。

## 9. 项目部署指南

### 9.1 后端部署

1. **打包项目**：在项目根目录执行
   ```
   mvn clean package
   ```
2. **运行jar包**：
   ```
   java -jar target/springmvc030-1.0-SNAPSHOT.jar
   ```

### 9.2 前端部署

1. **构建项目**：在frontend目录执行
   ```
   npm run build
   ```
2. **部署构建产物**：将`dist`目录部署到Nginx或其他Web服务器

## 10. 技术支持

如有任何问题或需要技术支持，请联系项目开发团队。